<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Set Caption — set_caption • flextable</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Set Caption — set_caption"><meta property="og:description" content="Set caption value in a flextable. The function
can also be used to define formattings that will be applied
if possible to Word and HTML outputs.
The caption will be associated with a paragraph style when
the output is Word. It can also be numbered as a auto-numbered
Word computed value.
The PowerPoint format ignores captions. PowerPoint documents are not
structured and do not behave as HTML documents and paginated documents
(word, pdf), and it's not possible to know where we should create
a shape to contain the caption (technically it can't be in the
PowerPoint shape containing the table).


When working with 'R Markdown' or 'Quarto', the caption settings
defined with set_caption() will be prioritized over knitr chunk options."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flextable</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Function reference</a>
</li>
<li>
  <a href="https://ardata-fr.github.io/flextable-book/" class="external-link">User Documentation</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/davidgohel/flextable/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Set Caption</h1>
    <small class="dont-index">Source: <a href="https://github.com/davidgohel/flextable/blob/HEAD/R/flextable.R" class="external-link"><code>R/flextable.R</code></a></small>
    <div class="hidden name"><code>set_caption.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Set caption value in a flextable. The function
can also be used to define formattings that will be applied
if possible to Word and HTML outputs.</p><ul><li><p>The caption will be associated with a paragraph style when
the output is Word. It can also be numbered as a auto-numbered
Word computed value.</p></li>
<li><p>The PowerPoint format ignores captions. PowerPoint documents are not
structured and do not behave as HTML documents and paginated documents
(word, pdf), and it's not possible to know where we should create
a shape to contain the caption (technically it can't be in the
PowerPoint shape containing the table).</p></li>
</ul><p>When working with 'R Markdown' or 'Quarto', the caption settings
defined with <code>set_caption()</code> will be prioritized over knitr chunk options.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">set_caption</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  caption <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  autonum <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  word_stylename <span class="op">=</span> <span class="st">"Table Caption"</span>,</span>
<span>  style <span class="op">=</span> <span class="va">word_stylename</span>,</span>
<span>  fp_p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  align_with_table <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  html_classes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  html_escape <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>flextable object</p></dd>


<dt>caption</dt>
<dd><p>caption value.</p></dd>


<dt>autonum</dt>
<dd><p>an autonum representation. See <code><a href="https://davidgohel.github.io/officer/reference/run_autonum.html" class="external-link">officer::run_autonum()</a></code>.
This has only an effect when output is Word. If used, the caption is preceded
by an auto-number sequence. In this case, the caption is preceded by an auto-number
sequence that can be cross referenced.</p></dd>


<dt>word_stylename, style</dt>
<dd><p>'Word' style name to associate with caption paragraph. These names are available with
function <code><a href="https://davidgohel.github.io/officer/reference/styles_info.html" class="external-link">officer::styles_info()</a></code> when output is Word. Argument <code>style</code>
is deprecated in favor of <code>word_stylename</code>.</p></dd>


<dt>fp_p</dt>
<dd><p>paragraph formatting properties associated with the caption, see <code><a href="https://davidgohel.github.io/officer/reference/fp_par.html" class="external-link">fp_par()</a></code>.
It applies when possible, i.e. in HTML and 'Word' but not with bookdown.</p></dd>


<dt>align_with_table</dt>
<dd><p>if TRUE, caption is aligned as the flextable, if FALSE,
<code>fp_p</code> will not be updated and alignement is as defined with <code>fp_p</code>.
It applies when possible, i.e. in HTML and 'Word' but not with bookdown.</p></dd>


<dt>html_classes</dt>
<dd><p>css class(es) to apply to associate with caption paragraph
when output is 'Word'.</p></dd>


<dt>html_escape</dt>
<dd><p>should HTML entities be escaped so that it can be safely
included as text or an attribute value within an HTML document.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The values defined by <code>set_caption()</code> will be preferred when possible, i.e. the
caption ID, the associated paragraph style, etc. Why specify "where possible"?
Because the principles differ from tool to tool. Here is what we have noticed
and tried to respect (if you think we are wrong, let us know):</p><ul><li><p>Word and HTML documents made with 'rmarkdown', i.e. with <code><a href="https://pkgs.rstudio.com/rmarkdown/reference/word_document.html" class="external-link">rmarkdown::word_document()</a></code>
and <code><a href="https://pkgs.rstudio.com/rmarkdown/reference/html_document.html" class="external-link">rmarkdown::html_document()</a></code> are not supposed to have numbered and cross-referenced captions.</p></li>
<li><p>PDF documents made with 'rmarkdown' <code><a href="https://pkgs.rstudio.com/rmarkdown/reference/pdf_document.html" class="external-link">rmarkdown::pdf_document()</a></code> automatically add numbers
before the caption.</p></li>
<li><p>Word and HTML documents made with 'bookdown' are supposed to have numbered and
cross-referenced captions. This is achieved by 'bookdown' but for technical reasons,
the caption must not be defined in an HTML or XML block. So with flextable we lose
the ability to format the caption content; surprisingly this is not the case with PDF.</p></li>
<li><p>HTML and PDF documents created with Quarto will manage captions and cross-references
differently; Quarto will replace captions with <code>tbl-cap</code> and <code>label</code> values.</p></li>
<li><p>Word documents made with Quarto are another specific case, Quarto does not
inject captions from the <code>tbl-cap</code> and <code>label</code> values. This is a temporary
situation that should evolve later. flextable' will evolve according to the
evolution of Quarto.</p></li>
</ul><p>Using officer enable all options specified with <code>set_caption()</code>.</p>
    </div>
    <div id="r-markdown">
    <h2>R Markdown</h2>
    


<p>flextable captions can be defined from R Markdown documents by using
<code>knitr::opts_chunk$set()</code>. The following options are available
with <code><a href="https://davidgohel.github.io/officedown/reference/rdocx_document.html" class="external-link">officedown::rdocx_document</a></code> and/or bookdown:</p><table class="table table"><tr><td><strong>label</strong></td><td><strong>name</strong></td><td><strong>value</strong></td></tr><tr><td>Word stylename to use for table captions.</td><td>tab.cap.style</td><td>NULL</td></tr><tr><td>caption id/bookmark</td><td>tab.id</td><td>NULL</td></tr><tr><td>caption</td><td>tab.cap</td><td>NULL</td></tr><tr><td>display table caption on top of the table or not</td><td>tab.topcaption</td><td>TRUE</td></tr><tr><td>caption table sequence identifier.</td><td>tab.lp</td><td>"tab:"</td></tr></table><p>The following options are only available when used with <code><a href="https://davidgohel.github.io/officedown/reference/rdocx_document.html" class="external-link">officedown::rdocx_document</a></code>:</p><table class="table table"><tr><td><strong>label</strong></td><td><strong>name</strong></td><td><strong>value</strong></td></tr><tr><td>prefix for numbering chunk (default to   "Table ").</td><td>tab.cap.pre</td><td>Table</td></tr><tr><td>suffix for numbering chunk (default to   ": ").</td><td>tab.cap.sep</td><td>" :"</td></tr><tr><td>title number depth</td><td>tab.cap.tnd</td><td>0</td></tr><tr><td>separator to use between title number and table number.</td><td>tab.cap.tns</td><td>"-"</td></tr><tr><td>caption prefix formatting properties</td><td>tab.cap.fp_text</td><td>fp_text_lite(bold = TRUE)</td></tr></table><p>See <a href="knit_print.flextable.html">knit_print.flextable</a> for more details.</p>
    </div>
    <div id="using-quarto-">
    <h2>Using 'Quarto'</h2>
    


<p>'Quarto' manage captions and cross-references instead of flextable. That's why
<code>set_caption()</code> is not useful in a 'Quarto' document except for Word documents
where 'Quarto' does not manage captions yet (when output is raw xml which is the
case for flextable).</p>
<p>knitr options are almost the same than those detailled in the R Markdown section (see upper),
but be aware that 'Quarto' manage captions and it can be overwrite what has
been defined by flextable. See Quarto documentation for more information.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="flextable.html">flextable()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">ftab</span> <span class="op">&lt;-</span> <span class="fu"><a href="flextable.html">flextable</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span> <span class="va">iris</span> <span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ftab</span> <span class="op">&lt;-</span> <span class="fu">set_caption</span><span class="op">(</span><span class="va">ftab</span>, <span class="st">"my caption"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ftab</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a flextable object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> col_keys: `Sepal.Length`, `Sepal.Width`, `Petal.Length`, `Petal.Width`, `Species` </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> header has 1 row(s) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> body has 6 row(s) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> original dataset sample: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          5.1         3.5          1.4         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          4.9         3.0          1.4         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          4.7         3.2          1.3         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          4.6         3.1          1.5         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          5.0         3.6          1.4         0.2  setosa</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ardata-fr.github.io/officeverse/" class="external-link">officer</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">autonum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidgohel.github.io/officer/reference/run_autonum.html" class="external-link">run_autonum</a></span><span class="op">(</span>seq_id <span class="op">=</span> <span class="st">"tab"</span>, bkm <span class="op">=</span> <span class="st">"mtcars"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ftab</span> <span class="op">&lt;-</span> <span class="fu"><a href="flextable.html">flextable</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span> <span class="va">mtcars</span> <span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ftab</span> <span class="op">&lt;-</span> <span class="fu">set_caption</span><span class="op">(</span><span class="va">ftab</span>, caption <span class="op">=</span> <span class="st">"mtcars data"</span>, autonum <span class="op">=</span> <span class="va">autonum</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ftab</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a flextable object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> col_keys: `mpg`, `cyl`, `disp`, `hp`, `drat`, `wt`, `qsec`, `vs`, `am`, `gear`, `carb` </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> header has 1 row(s) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> body has 6 row(s) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> original dataset sample: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    mpg cyl disp  hp drat    wt  qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><link href="../ardata.css" rel="stylesheet"><div class="author">
  <p>Version 0.8.1 - Developed by  - proudly brought to you by <a href="http://www.ardata.fr" class="external-link"><img alt="ardata" src="../ardata-logo.svg" style="vertical-align:middle;height:24px;"></a>
  </p>
</div>
<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> .</p>
</div>

      </footer></div>

  


  

  </body></html>

